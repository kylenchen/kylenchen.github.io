<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Openwrt路由服务配置与应用 | Kylen's Blog</title><meta name="description" content="Openwrt路由服务配置与应用"><meta name="keywords" content="OpenWrt,路由器"><meta name="author" content="Kylen Chan"><meta name="copyright" content="Kylen Chan"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC&amp;family=Ma+Shan+Zheng&amp;display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://booku.ltd/posts/router-openwrt/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Openwrt路由服务配置与应用"><meta name="twitter:description" content="Openwrt路由服务配置与应用"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/cover/router-openwrt.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Openwrt路由服务配置与应用"><meta property="og:url" content="https://booku.ltd/posts/router-openwrt/"><meta property="og:site_name" content="Kylen's Blog"><meta property="og:description" content="Openwrt路由服务配置与应用"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/cover/router-openwrt.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="AWS lightsail实现用SSH root用户登录" href="https://booku.ltd/posts/lightsail-ssh/"><link rel="next" title="旁路由设置的三种方式" href="https://booku.ltd/posts/siderouter/"><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">26</div></a></div></div><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">29</div></a></div></div><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-address-card"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-modx" aria-hidden="true"></i><span> 兴趣</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/webnav/"><i class="fa-fw fa fa-paper-plane"></i><span> 导航</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#%E5%89%8D%E8%A8%80"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">前言</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Aria2%E6%9C%8D%E5%8A%A1"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Aria2服务</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Emby%E5%AA%92%E4%BD%93%E6%9C%8D%E5%8A%A1"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">Emby媒体服务</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Centos7%E4%B8%8E%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">Centos7与宝塔面板</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Rclone%E5%B7%A5%E5%85%B7"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">Rclone工具</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#FileBrowser"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">FileBrowser</span></a></li></ol></div></div></div><script>var GLOBAL_CONFIG = {
  root: '/',
  hexoVersion: '5.2.0',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://jerryc.me/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  highlight_shrink: 'false',
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  islazyload: true,
  runtime_unit: '天'


}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Tech & Life" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Aria2%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.</span> <span class="toc-text">Aria2服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Emby%E5%AA%92%E4%BD%93%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.</span> <span class="toc-text">Emby媒体服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Centos7%E4%B8%8E%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF"><span class="toc-number">4.</span> <span class="toc-text">Centos7与宝塔面板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rclone%E5%B7%A5%E5%85%B7"><span class="toc-number">5.</span> <span class="toc-text">Rclone工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FileBrowser"><span class="toc-number">6.</span> <span class="toc-text">FileBrowser</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/header/post-bg.jpg)"><header><div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Kylen's Blog</a></span><i class="fa fa-bars toggle-menu pull-right close" aria-hidden="true"><!--.open.toggle-menu.pull-right//.menu-icon-first
//.menu-icon-second
//.menu-icon-third
--></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-address-card"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-modx" aria-hidden="true"></i><span> 兴趣</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/webnav/"><i class="fa-fw fa fa-paper-plane"></i><span> 导航</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="post-info"><div id="post-title"><div class="posttitle">Openwrt路由服务配置与应用</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-11-04<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2022-11-08</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%B7%AF%E7%94%B1/">路由</a></span><div class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计: </span><span class="word-count">1.9k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 7 分钟</span><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"></i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>U盘使用flippy版Openwrt开启docker。flippy大神限制，N1在安装Openwrt后必须要刷入emmc才会自动启动docker，且如果直接用service开启docker会出现缓存不足的错误。该问题主要是大神将docker的挂载点设置到了emmc，所以才会出现这个问题。<code>Docker-CE</code>说明： N1在 U盘上不启用docker，写入emmc后自动启用，数据目录是 <code>/mnt/mmcblk1p3/docker</code>，因此，解决问题的办法是只要把docker的挂载点加载出来就可以解决。可以利用U盘本身的剩余空间/外置存储设备作为挂载点。</p>
<p>比较方便的做法为：首先在windows上利用分区工具将U盘剩余空间新建EXT4分区，之后将U盘插入N1启动进入Openwrt<br>在系统——挂载点—–处找到创建的分区（一般为<code>/dev/sda3</code>）<br>点击：挂载点———–挂载点——–添加<br>选中：启用此挂载点————UUID处选择你创建的分区/外置存储设备————-挂载点自定义为<code>/mnt/mmcblk1p3/</code>——–保存&amp;应用</p>
<p>或者可以修改<code>daemon.json</code>文件，直接在终端输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>

<p>将”<code>data-root</code>“中<code>/mnt/mmcblk1p3/docker/</code>修改成你要的地址。如<code>/mnt/sda3/docker</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;bip&quot;</span>: <span class="string">&quot;172.31.0.1/24&quot;</span>,</span><br><span class="line"><span class="string">&quot;data-root&quot;</span>: <span class="string">&quot;/mnt/mmcblk1p3/docker/&quot;</span>,</span><br><span class="line"><span class="string">&quot;log-level&quot;</span>: <span class="string">&quot;warn&quot;</span>,</span><br><span class="line"><span class="string">&quot;log-driver&quot;</span>: <span class="string">&quot;json-file&quot;</span>,</span><br><span class="line"><span class="string">&quot;log-opts&quot;</span>: &#123;</span><br><span class="line"><span class="string">&quot;max-size&quot;</span>: <span class="string">&quot;10m&quot;</span>,</span><br><span class="line"><span class="string">&quot;max-file&quot;</span>: <span class="string">&quot;5&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line"><span class="string">&quot;https://dockerhub.azk8s.cn&quot;</span></span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Aria2服务"><a href="#Aria2服务" class="headerlink" title="Aria2服务"></a>Aria2服务</h2><p>Aria2 是一个多平台轻量级，支持 <code>HTTP、FTP、BitTorrent</code> 等多协议、多来源的命令行下载工具。Aria2 可以从多个来源、多个协议下载资源，最大的程度上利用了你的带宽。Aria2 有着非常小的资源占用，在关闭磁盘缓存的情况下，物理内存占用通常为 4M（正常 <code>HTTP/FTP</code> 下载的情况下），BitTorrent 下载每秒<code>2.8M/S</code>的情况下，CPU 占有率约为 <code>6%</code>。Aria2 支持 JSON-RPC 和 XML-RPC 接口远程调用。</p>
<p>Openwrt启动Aria2服务之前，需对Aria2配置。新建aria2文件夹，修改默认下载目录为新建的aria2文件夹。注意保存之前一定新建好下载的文件夹，不然启动不了。设置aria2文件夹权限，否则下载失败</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 aria2/</span><br></pre></td></tr></table></figure>

<h2 id="Emby媒体服务"><a href="#Emby媒体服务" class="headerlink" title="Emby媒体服务"></a>Emby媒体服务</h2><p>使用docker安装<code>Emby Server</code>镜像。<code>hub.docker.com</code>网站<code>Emby Server</code>镜像包有几种，本次试验的CPU为arm架构，故选择<code>emby/embyserver_arm64v8</code>镜像。新建下面文件夹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /mnt/mmcblk1p3/emby/config</span><br><span class="line">mkdir -p /mnt/mmcblk1p3/emby/videos</span><br></pre></td></tr></table></figure>

<p>拉取镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull emby/embyserver_arm64v8</span><br></pre></td></tr></table></figure>

<p><code>Emby Server</code>运行启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name emby --restart=always -v /mnt/mmcblk1p3/emby/config:/config -v /mnt/mmcblk1p3/emby/videos:/videos -d -p 8096:8096 emby/embyserver_arm64v8:latest</span><br></pre></td></tr></table></figure>

<p>设备启动后，容器也能自启动，OK。<br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/post/router-openwrt/1.png"></p>
<h2 id="Centos7与宝塔面板"><a href="#Centos7与宝塔面板" class="headerlink" title="Centos7与宝塔面板"></a>Centos7与宝塔面板</h2><p>基于F大的<code>Openwrt 40+</code>测试，其他固件或版本可能不适用此教程。</p>
<p><strong>1. 安装Docker管理工具Portainer</strong></p>
<p>由于F大的<code>Openwrt 40+</code>已安装docker，且已经给出简单安装Portainer的方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/docker-web</span><br></pre></td></tr></table></figure>

<p>安装完成后，默认端口<code>9999</code>，建议先进入网页设置账户及密码，选本地 Local 连接进入网页一次。<br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/post/router-openwrt/2.png"></p>
<p><strong>2. 创建Centos7容器</strong></p>
<p>拉取Centos镜像，从镜像创建容器，这里特别说明使用“<code>/usr/sbin/init</code>”参数，路由重启后，会造成可视化窗口portainer无法启动（后面给到解决方案），使用此参数，而不是“<code>/bin/bash</code>”的好处，在于Centos7可以开机自启动，例如容器内的“<code>bt、ssh、crontab</code>”等都能随着路由的开机自动启动。（未测试）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos:7 <span class="comment">#拉取下载centos7镜像</span></span><br><span class="line">docker run -d --name bt --net=host -i -t --privileged=<span class="literal">true</span> --restart=always centos:7 /bin/bash <span class="comment">#从docker镜像创建名为bt的容器</span></span><br></pre></td></tr></table></figure>

<p>SSH进入容器Centos7</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it bt &#x2F;bin&#x2F;bash #进入容器</span><br></pre></td></tr></table></figure>

<p>安装SSH及其它常用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum update <span class="comment">#更新</span></span><br><span class="line">yum install -y wget <span class="comment">#安装wget</span></span><br><span class="line">yum install -y net-tools <span class="comment">#安装ifconfig查看器</span></span><br><span class="line">yum install -y openssl openssh-server <span class="comment">#安装ssh服务</span></span><br><span class="line">yum install -y initscripts <span class="comment">#安装Service服务</span></span><br></pre></td></tr></table></figure>
<p>添加SSH参数并启动SSH</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -q -t rsa -b 2048 -f /etc/ssh/ssh_host_rsa_key -N <span class="string">&#x27;&#x27;</span></span><br><span class="line">ssh-keygen -q -t ecdsa -f /etc/ssh/ssh_host_ecdsa_key -N <span class="string">&#x27;&#x27;</span></span><br><span class="line">ssh-keygen -t dsa -f /etc/ssh/ssh_host_ed25519_key -N <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>编辑SSH配置文件，更改并启用端口。修改22端口避免和Openwrt冲突，这里改为822，并去除“#”注释开启<code>PermitRootLogin yes</code>允许root登录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config   <span class="comment">#编辑文件</span></span><br></pre></td></tr></table></figure>

<p>启动SSH服务，当没有报错，并出现PID号，说明启动成功。你可以路由<code>ip+822</code>端口SSH访问容器Centos7。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/sshd -D &amp;</span><br></pre></td></tr></table></figure>

<p>如果安装了宝塔面板ssh登录端口，一定要进入登录宝塔网页后台，找到安全——防火墙，添加822 放行端口，不然可能无法连接容器ssh的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd  #修改容器账户名为root的ssh登录密码</span><br></pre></td></tr></table></figure>

<p><strong>3. 宝塔面板</strong></p>
<p>安装宝塔面板5.9，安装完成就可以登录了，宝塔面板7.0以上版本可能安装失败。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget &amp;&amp; wget -O install.sh http://download.bt.cn/install/install.sh &amp;&amp; sh install.sh</span><br></pre></td></tr></table></figure>

<p>宝塔安装过程中，如有错误代码如：<code>You are using pip version 9.0.1, however version 20.1.1 is available</code> ，可以使用下面命令升级</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y install epel-release python-pip</span><br><span class="line">yum -y install python-pip</span><br><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure>

<p>LNMP总是出现各种错误，安装失败，执行日志报错如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;configure: error: the HTTP image filter module requires the GD library.</span><br><span class="line">You can either do not enable the module or install the libraries.</span><br><span class="line"></span><br><span class="line">make: *** No rule to make target &#96;build&#39;, needed by &#96;default&#39;.  Stop.</span><br></pre></td></tr></table></figure>

<p>载安装完gd图形库安装更新成功，命令如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gd-devel</span><br></pre></td></tr></table></figure>

<p>另一报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">configure: error: Invalid C++ compiler or C++ compiler flags</span><br><span class="line">make[1]: *** [pcre-8.43&#x2F;Makefile] Error 1</span><br><span class="line">make[1]: Leaving directory &#96;&#x2F;www&#x2F;server&#x2F;nginx&#x2F;src&#39;</span><br><span class="line">make: *** [install] Error 2</span><br></pre></td></tr></table></figure>

<p>执行命令，得以解决</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc-c++</span><br></pre></td></tr></table></figure>

<p>还有错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">make[2]: Leaving directory &#96;&#x2F;www&#x2F;server&#x2F;nginx&#x2F;src&#x2F;openssl&#39;</span><br><span class="line">Operating system: aarch64-whatever-linux2</span><br><span class="line">You need Perl 5.</span><br><span class="line">make[1]: *** [&#x2F;www&#x2F;server&#x2F;nginx&#x2F;src&#x2F;openssl&#x2F;.openssl&#x2F;include&#x2F;openssl&#x2F;ssl.h] Error 1</span><br><span class="line">make[1]: Leaving directory &#96;&#x2F;www&#x2F;server&#x2F;nginx&#x2F;src&#39;</span><br><span class="line">make: *** [install] Error 2</span><br></pre></td></tr></table></figure>

<p>Nginx安装加载ssl错误openssl问题。执行<code>yum install openssl openssl-devel</code>命令，也未能解决。本想用下面命令升级宝塔面板版本，结果升级失败了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://download.bt.cn/install/update_to_6.sh|bash</span><br></pre></td></tr></table></figure>

<p>虽然升级宝塔面板失败了，但是安装<code>LNMP（Ngnix1.14，MySQL5.5，PHP7.2，phpMyAdmin4.4）</code>成功了 ，一脸懵逼，以后有时间再研究。重启路由后，宝塔面板不能自启动，可以参考恩山论坛的解决方法，这里不给方法。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/bt stop    <span class="comment">#停止</span></span><br><span class="line">/etc/init.d/bt start    <span class="comment">#启动</span></span><br><span class="line">/etc/init.d/bt restart    <span class="comment">#重启</span></span><br><span class="line">/etc/init.d/bt default    <span class="comment">#忘记帐号密码</span></span><br><span class="line">/etc/init.d/bt stop &amp;&amp; chkconfig --del bt &amp;&amp; rm -f /etc/init.d/bt &amp;&amp; rm -rf /www/server/panel    <span class="comment">#卸载</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/post/router-openwrt/3.png"></p>
<h2 id="Rclone工具"><a href="#Rclone工具" class="headerlink" title="Rclone工具"></a>Rclone工具</h2><p>Rclone 是一款的命令行工具，支持在不同对象存储、网盘间同步、上传、下载数据。运行 Rclone 开始配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./rclone config</span><br></pre></td></tr></table></figure>

<p>挂载rclone磁盘目录与卸载rclone磁盘目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rclone mount 起的名字: /挂载的目录 --allow-other --allow-non-empty --vfs-cache-mode writes &amp;</span><br><span class="line">df -h <span class="comment">#查看是否挂载成功</span></span><br><span class="line">fusermount -qzu /挂载的目录</span><br></pre></td></tr></table></figure>

<p>其他详细步骤可以搜索相关教程，例如磁盘的自启动挂载。</p>
<h2 id="FileBrowser"><a href="#FileBrowser" class="headerlink" title="FileBrowser"></a>FileBrowser</h2><p>文件浏览器是一种创建你自己的云的软件，你可以在服务器上安装它，将它指向一个路径，然后通过一个漂亮的web界面访问你的文件。默认用户名/密码: admin/admin</p>
<p>第一次运行务必填好项目存放目录，然后保存应用。再手动下载，否则无法使用！<br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/post/router-openwrt/4.png"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Kylen Chan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://booku.ltd/posts/router-openwrt/">https://booku.ltd/posts/router-openwrt/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://booku.ltd">Kylen's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/OpenWrt/">OpenWrt</a><a class="post-meta__tags" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/">路由器</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/cover/router-openwrt.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/posts/lightsail-ssh/"><img class="prev_cover" data-src="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/cover/lightsail-ssh.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>AWS lightsail实现用SSH root用户登录</span></div></a></div><div class="next-post pull-right"><a href="/posts/siderouter/"><img class="next_cover" data-src="https://cdn.jsdelivr.net/gh/kylenchen/CDN@latest/cover/siderouter.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>旁路由设置的三种方式</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div class="vcomment"></div><!-- script(src='https://cdn1.lncld.net/static/js/3.0.4/av-min.js')--><!-- script(src=url_for('/js/av-min.js'))--><!-- script(src=url_for('/js/Valine.min.js'))--><script src="/js/MiniValine.min.js"></script><!-- script(src='https://unpkg.com/minivaline@2.7.3/dist/MiniValine.min.js')--><script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new MiniValine({
  el:'.vcomment',
  notify:notify,
  verify:verify,
  emoticon_url:  '/img/alu',
  emoticon_list: ["吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"],
  appId:'F342JVkLzRBxNoSXcdVWjbD0-MdYXbMMI',
  appKey:'EwwbAbHbFCst2qjae3ATpOeM',
  placeholder:'Write a comment',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10',
  serverURLs:'https://f342jvkl.api.lncldglobal.com',
  lang: 'zh-CN'
})</script></div></div></div><footer><div class="layout" id="footer"><div class="copyright">Copyright &copy;2018 - 2022 By Kylen Chan</div><div class="footer_custom_text">未来未至,  至所未致</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><section class="rightside" id="rightside"><i class="fa fa-list-ul close" id="mobile-toc-button" title="rightside.toc" aria-hidden="true"></i><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="fa fa-moon-o nightshift" id="nightshift" title="夜间模式"></i></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2.2.1/src/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script async src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script id="ribbon" src="/js/third-party/piao.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.iife.min.js" async></script><!--script.// const observer = lozad(); // lazy loads elements with default selector as '.lozad'
// observer.observe();--><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>